import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import React, { useState, useEffect } from 'react';
import axios from 'axios';
import Home from './Home';
import { FaWallet, FaCreditCard, FaHistory } from 'react-icons/fa';
import Footers from './Footers';
const WalletPage = () => {
    const [wallet, setWallet] = useState(null);
    const [showDepositForm, setShowDepositForm] = useState(false);
    const [showHistory, setShowHistory] = useState(false);
    const [depositAmount, setDepositAmount] = useState('');
    const [transferInfo, setTransferInfo] = useState(null);
    const [depositHistory, setDepositHistory] = useState([]);
    const suggestedAmounts = [
        { label: '100K', value: 100000 },
        { label: '200K', value: 200000 },
        { label: '500K', value: 500000 },
        { label: '1M', value: 1000000 },
        { label: '2M', value: 2000000 },
        { label: '5M', value: 5000000 },
    ];
    const formatPrice = (price) => {
        return new Intl.NumberFormat('vi-VN').format(price);
    };
    const selectAmount = (amount) => {
        setDepositAmount(amount.toString());
    };
    const handleDeposit = async () => {
        if (!depositAmount || depositAmount <= 0) {
            alert('Vui lòng nhập số tiền hợp lệ');
            return;
        }
        try {
            const token = localStorage.getItem('token');
            const response = await axios.post('https://tgdd-be.mhoa.id.vn/api/wallet/deposit', { amount: parseInt(depositAmount) }, { headers: { Authorization: `Bearer ${token}` } });
            setTransferInfo(response.data);
            alert('Yêu cầu nạp tiền đã được tạo! Vui lòng chuyển khoản theo thông tin bên dưới.');
        }
        catch (error) {
            console.error('Lỗi nạp tiền:', error);
            alert('Có lỗi xảy ra khi tạo yêu cầu nạp tiền');
        }
    };
    const fetchWalletInfo = async () => {
        try {
            const token = localStorage.getItem('token');
            const response = await axios.get('https://tgdd-be.mhoa.id.vn/api/wallet', {
                headers: { Authorization: `Bearer ${token}` }
            });
            setWallet(response.data.wallet);
            setDepositHistory(response.data.depositHistory || []);
        }
        catch (error) {
            console.error('Lỗi lấy thông tin ví:', error);
        }
    };
    const getStatusColor = (status) => {
        switch (status) {
            case 'approved': return 'bg-green-100 text-green-800';
            case 'pending': return 'bg-yellow-100 text-yellow-800';
            case 'rejected': return 'bg-red-100 text-red-800';
            default: return 'bg-gray-100 text-gray-800';
        }
    };
    const getStatusText = (status) => {
        switch (status) {
            case 'approved': return 'Đã duyệt';
            case 'pending': return 'Chờ duyệt';
            case 'rejected': return 'Từ chối';
            default: return 'Không xác định';
        }
    };
    useEffect(() => {
        fetchWalletInfo();
    }, []);
    return (_jsxs("div", { className: "min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100", children: [_jsx(Home, {}), _jsxs("div", { className: "max-w-7xl mx-auto p-8", children: [_jsx("div", { className: "text-center mb-12", children: _jsxs("div", { className: "flex items-center justify-center gap-4 mb-6", children: [_jsx("div", { className: "w-16 h-16 bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl flex items-center justify-center shadow-lg", children: _jsx(FaWallet, { className: "text-2xl text-white" }) }), _jsx("h1", { className: "text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent", children: "V\u00ED \u0111i\u1EC7n t\u1EED" })] }) }), _jsxs("div", { className: "grid lg:grid-cols-3 gap-8", children: [_jsxs("div", { className: "lg:col-span-1 space-y-6", children: [_jsxs("div", { className: "relative overflow-hidden bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700 text-white rounded-3xl shadow-2xl", children: [_jsx("div", { className: "absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16" }), _jsx("div", { className: "absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full translate-y-12 -translate-x-12" }), _jsxs("div", { className: "relative p-8", children: [_jsxs("div", { className: "flex items-center justify-between mb-6", children: [_jsxs("div", { children: [_jsx("p", { className: "text-blue-100 text-sm font-medium", children: "S\u1ED1 d\u01B0 kh\u1EA3 d\u1EE5ng" }), _jsx("h2", { className: "text-3xl font-bold mt-1", children: formatPrice(wallet?.balance || 0) }), _jsx("p", { className: "text-blue-100 text-lg", children: "VN\u0110" })] }), _jsx("div", { className: "w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center", children: _jsx(FaCreditCard, { className: "text-xl" }) })] }), _jsxs("div", { className: "flex items-center gap-2 text-green-300 text-sm", children: [_jsx("div", { className: "w-2 h-2 bg-green-300 rounded-full animate-pulse" }), _jsx("span", { children: "T\u00E0i kho\u1EA3n \u0111ang ho\u1EA1t \u0111\u1ED9ng" })] })] })] }), _jsxs("div", { className: "grid grid-cols-2 gap-4", children: [_jsx("div", { className: "bg-white rounded-2xl p-6 shadow-lg border border-gray-100", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center", children: _jsx("span", { className: "text-green-600 text-lg", children: "\uD83D\uDCC8" }) }), _jsxs("div", { children: [_jsx("p", { className: "text-gray-500 text-xs", children: "T\u1ED5ng n\u1EA1p" }), _jsx("p", { className: "font-bold text-green-600", children: formatPrice(depositHistory
                                                                        .filter(t => t.status === 'approved')
                                                                        .reduce((sum, t) => sum + parseInt(t.amount), 0)) })] })] }) }), _jsx("div", { className: "bg-white rounded-2xl p-6 shadow-lg border border-gray-100", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("div", { className: "w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center", children: _jsx("span", { className: "text-blue-600 text-lg", children: "\uD83D\uDCCA" }) }), _jsxs("div", { children: [_jsx("p", { className: "text-gray-500 text-xs", children: "Giao d\u1ECBch" }), _jsx("p", { className: "font-bold text-blue-600", children: depositHistory.length })] })] }) })] }), _jsxs("div", { className: "space-y-3", children: [_jsx("button", { onClick: () => {
                                                    setShowDepositForm(true);
                                                    setShowHistory(false);
                                                }, className: `w-full py-4 px-6 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 ${showDepositForm
                                                    ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-green-200'
                                                    : 'bg-white hover:bg-green-50 text-green-600 border-2 border-green-200 hover:border-green-300'}`, children: _jsxs("div", { className: "flex items-center justify-center gap-3", children: [_jsx("span", { className: "text-xl", children: "\uD83D\uDCB0" }), _jsx("span", { children: "N\u1EA1p ti\u1EC1n v\u00E0o v\u00ED" })] }) }), _jsx("button", { onClick: () => {
                                                    setShowHistory(true);
                                                    setShowDepositForm(false);
                                                }, className: `w-full py-4 px-6 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 ${showHistory
                                                    ? 'bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-orange-200'
                                                    : 'bg-white hover:bg-orange-50 text-orange-600 border-2 border-orange-200 hover:border-orange-300'}`, children: _jsxs("div", { className: "flex items-center justify-center gap-3", children: [_jsx(FaHistory, { className: "text-lg" }), _jsx("span", { children: "L\u1ECBch s\u1EED giao d\u1ECBch" })] }) })] })] }), _jsxs("div", { className: "lg:col-span-2", children: [showDepositForm && (_jsxs("div", { className: "bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden", children: [_jsx("div", { className: "bg-gradient-to-r from-green-500 to-emerald-600 p-8 text-white", children: _jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center", children: _jsx("span", { className: "text-2xl", children: "\uD83D\uDCB3" }) }), _jsxs("div", { children: [_jsx("h3", { className: "text-2xl font-bold", children: "N\u1EA1p ti\u1EC1n v\u00E0o v\u00ED" }), _jsx("p", { className: "text-green-100", children: "Ch\u1ECDn s\u1ED1 ti\u1EC1n v\u00E0 ph\u01B0\u01A1ng th\u1EE9c thanh to\u00E1n" })] })] }) }), _jsxs("div", { className: "p-8", children: [_jsxs("div", { className: "mb-8", children: [_jsx("label", { className: "block text-sm font-semibold text-gray-700 mb-4", children: "S\u1ED1 ti\u1EC1n mu\u1ED1n n\u1EA1p" }), _jsxs("div", { className: "relative", children: [_jsx("input", { type: "number", placeholder: "Nh\u1EADp s\u1ED1 ti\u1EC1n...", value: depositAmount, onChange: (e) => setDepositAmount(e.target.value), className: "w-full p-6 text-2xl font-bold border-2 border-gray-200 rounded-2xl focus:outline-none focus:border-green-500 focus:ring-4 focus:ring-green-100 transition-all" }), _jsx("span", { className: "absolute right-6 top-1/2 transform -translate-y-1/2 text-gray-400 font-semibold text-lg", children: "VN\u0110" })] })] }), _jsxs("div", { className: "mb-8", children: [_jsx("p", { className: "text-sm font-semibold text-gray-700 mb-4", children: "Ch\u1ECDn nhanh" }), _jsx("div", { className: "grid grid-cols-3 gap-4", children: suggestedAmounts.map((amount, index) => (_jsx("button", { onClick: () => selectAmount(amount.value), className: `p-4 rounded-xl text-sm font-semibold transition-all duration-200 ${depositAmount == amount.value
                                                                        ? 'bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg transform scale-105'
                                                                        : 'bg-gray-50 hover:bg-gray-100 text-gray-700 border border-gray-200'}`, children: amount.label }, index))) })] }), _jsxs("div", { className: "mb-8", children: [_jsx("p", { className: "text-sm font-semibold text-gray-700 mb-4", children: "Ph\u01B0\u01A1ng th\u1EE9c thanh to\u00E1n" }), _jsx("div", { className: "bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-2xl p-6", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mr-6", children: _jsx("span", { className: "text-white text-2xl font-bold", children: "\u20AB" }) }), _jsxs("div", { className: "flex-1", children: [_jsx("p", { className: "font-bold text-gray-800 text-lg", children: "Chuy\u1EC3n kho\u1EA3n ng\u00E2n h\u00E0ng" }), _jsx("p", { className: "text-gray-600", children: "Vietcombank \u2022 An to\u00E0n & Nhanh ch\u00F3ng" })] }), _jsx("div", { className: "text-green-500", children: _jsx("svg", { className: "w-8 h-8", fill: "currentColor", viewBox: "0 0 20 20", children: _jsx("path", { fillRule: "evenodd", d: "M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z", clipRule: "evenodd" }) }) })] }) })] }), _jsx("div", { className: "bg-gray-50 rounded-2xl p-6 mb-8", children: _jsxs("div", { className: "flex justify-between items-center", children: [_jsx("span", { className: "text-gray-700 font-semibold text-lg", children: "T\u1ED5ng thanh to\u00E1n" }), _jsxs("span", { className: "text-3xl font-bold text-green-600", children: [formatPrice(depositAmount || 0), " VN\u0110"] })] }) }), _jsxs("div", { className: "flex gap-4", children: [_jsx("button", { onClick: () => setShowDepositForm(false), className: "flex-1 py-4 border-2 border-gray-300 rounded-2xl text-gray-700 font-semibold hover:bg-gray-50 transition-all", children: "H\u1EE7y b\u1ECF" }), _jsx("button", { onClick: handleDeposit, className: "flex-1 py-4 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white rounded-2xl font-semibold transition-all shadow-lg hover:shadow-xl", children: "X\u00E1c nh\u1EADn n\u1EA1p ti\u1EC1n" })] }), transferInfo && (_jsxs("div", { className: "mt-8 p-6 bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl", children: [_jsxs("div", { className: "flex items-center gap-3 mb-4", children: [_jsx("div", { className: "w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center", children: _jsx("span", { className: "text-white text-lg", children: "\uD83C\uDFE6" }) }), _jsx("h4", { className: "text-xl font-bold text-gray-800", children: "Th\u00F4ng tin chuy\u1EC3n kho\u1EA3n" })] }), _jsxs("div", { className: "bg-white rounded-xl p-6 shadow-sm", children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-6", children: [_jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-600 mb-1", children: "Ng\u00E2n h\u00E0ng" }), _jsx("p", { className: "text-lg font-bold text-gray-800", children: transferInfo.bankInfo.bank })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-600 mb-1", children: "S\u1ED1 t\u00E0i kho\u1EA3n" }), _jsx("p", { className: "text-lg font-bold text-blue-600 font-mono", children: transferInfo.bankInfo.accountNumber })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-600 mb-1", children: "Ch\u1EE7 t\u00E0i kho\u1EA3n" }), _jsx("p", { className: "text-lg font-bold text-gray-800", children: transferInfo.bankInfo.accountName })] }), _jsxs("div", { children: [_jsx("p", { className: "text-sm text-gray-600 mb-1", children: "S\u1ED1 ti\u1EC1n" }), _jsxs("p", { className: "text-lg font-bold text-red-600", children: [formatPrice(depositAmount), " VN\u0110"] })] })] }), _jsxs("div", { className: "mt-6 pt-4 border-t border-gray-200", children: [_jsx("p", { className: "text-sm text-gray-600 mb-1", children: "N\u1ED9i dung chuy\u1EC3n kho\u1EA3n" }), _jsxs("div", { className: "flex items-center gap-3", children: [_jsx("p", { className: "text-lg font-bold text-green-600 font-mono bg-green-50 px-4 py-2 rounded-lg flex-1", children: transferInfo.transferCode }), _jsx("button", { onClick: () => navigator.clipboard.writeText(transferInfo.transferCode), className: "px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm font-medium transition-colors", children: "Copy" })] })] })] }), _jsx("div", { className: "mt-4 p-4 bg-blue-50 border border-blue-200 rounded-xl", children: _jsxs("div", { className: "flex items-start gap-3", children: [_jsx("span", { className: "text-blue-500 text-lg", children: "\u2139\uFE0F" }), _jsxs("div", { className: "text-sm text-blue-700", children: [_jsx("p", { className: "font-semibold mb-1", children: "L\u01B0u \u00FD quan tr\u1ECDng:" }), _jsxs("ul", { className: "list-disc list-inside space-y-1", children: [_jsx("li", { children: "Vui l\u00F2ng chuy\u1EC3n kho\u1EA3n \u0111\u00FAng s\u1ED1 ti\u1EC1n v\u00E0 n\u1ED9i dung" }), _jsx("li", { children: "Th\u1EDDi gian x\u1EED l\u00FD: 5-15 ph\u00FAt sau khi chuy\u1EC3n kho\u1EA3n" }), _jsx("li", { children: "Li\u00EAn h\u1EC7 h\u1ED7 tr\u1EE3 n\u1EBFu sau 30 ph\u00FAt ch\u01B0a \u0111\u01B0\u1EE3c duy\u1EC7t" })] })] })] }) })] }))] })] })), showHistory && (_jsxs("div", { className: "bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden", children: [_jsx("div", { className: "bg-gradient-to-r from-orange-500 to-red-500 p-8 text-white", children: _jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center", children: _jsx(FaHistory, { className: "text-2xl" }) }), _jsxs("div", { children: [_jsx("h3", { className: "text-2xl font-bold", children: "L\u1ECBch s\u1EED giao d\u1ECBch" }), _jsx("p", { className: "text-orange-100", children: "Theo d\u00F5i t\u1EA5t c\u1EA3 giao d\u1ECBch n\u1EA1p ti\u1EC1n" })] })] }) }), _jsxs("div", { className: "p-8", children: [depositHistory.length === 0 ? (_jsxs("div", { className: "text-center py-16", children: [_jsx("div", { className: "w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6", children: _jsx("span", { className: "text-4xl" }) }), _jsx("h4", { className: "text-xl font-semibold text-gray-800 mb-2", children: "Ch\u01B0a c\u00F3 giao d\u1ECBch" }), _jsx("p", { className: "text-gray-500", children: "L\u1ECBch s\u1EED n\u1EA1p ti\u1EC1n s\u1EBD hi\u1EC3n th\u1ECB t\u1EA1i \u0111\u00E2y" })] })) : (_jsx("div", { className: "space-y-4 max-h-96 overflow-y-auto", children: depositHistory.map((transaction, index) => (_jsxs("div", { className: "border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all", children: [_jsxs("div", { className: "flex justify-between items-start mb-4", children: [_jsxs("div", { className: "flex items-center gap-4", children: [_jsx("div", { className: "w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center", children: _jsx("span", { className: "text-blue-600 text-xl", children: "\uD83D\uDCB0" }) }), _jsxs("div", { children: [_jsx("p", { className: "font-semibold text-gray-800 text-lg", children: "N\u1EA1p ti\u1EC1n v\u00E0o v\u00ED" }), _jsx("p", { className: "text-gray-500", children: new Date(transaction.created_at).toLocaleString('vi-VN') })] })] }), _jsxs("div", { className: "text-right", children: [_jsxs("p", { className: "text-2xl font-bold text-green-600", children: ["+", formatPrice(transaction.amount), " VN\u0110"] }), _jsx("span", { className: `px-3 py-1 text-sm rounded-full font-medium ${getStatusColor(transaction.status)}`, children: getStatusText(transaction.status) })] })] }), _jsxs("div", { className: "bg-gray-50 rounded-xl p-4", children: [_jsxs("div", { className: "grid grid-cols-2 gap-4 mb-3", children: [_jsxs("div", { children: [_jsx("span", { className: "text-gray-600 text-sm", children: "M\u00E3 giao d\u1ECBch:" }), _jsx("p", { className: "font-mono text-blue-600 font-semibold", children: transaction.transfer_code })] }), _jsxs("div", { children: [_jsx("span", { className: "text-gray-600 text-sm", children: "Ng\u00E2n h\u00E0ng:" }), _jsx("p", { className: "font-semibold", children: transaction.bank_account?.split(' - ')[0] || 'Vietcombank' })] })] }), transaction.status === 'pending' && (_jsx("div", { className: "bg-yellow-50 border-l-4 border-yellow-400 rounded p-3", children: _jsx("p", { className: "text-yellow-700 text-sm", children: "\u23F3 \u0110ang ch\u1EDD x\u00E1c nh\u1EADn t\u1EEB admin. Th\u1EDDi gian x\u1EED l\u00FD: 5-15 ph\u00FAt" }) })), transaction.status === 'approved' && (_jsx("div", { className: "bg-green-50 border-l-4 border-green-400 rounded p-3", children: _jsx("p", { className: "text-green-700 text-sm", children: "\u2705 Giao d\u1ECBch th\u00E0nh c\u00F4ng! S\u1ED1 d\u01B0 \u0111\u00E3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt" }) })), transaction.status === 'rejected' && (_jsx("div", { className: "bg-red-50 border-l-4 border-red-400 rounded p-3", children: _jsx("p", { className: "text-red-700 text-sm", children: "\u274C Giao d\u1ECBch b\u1ECB t\u1EEB ch\u1ED1i. Vui l\u00F2ng li\u00EAn h\u1EC7 h\u1ED7 tr\u1EE3" }) }))] })] }, index))) })), depositHistory.length > 0 && (_jsx("div", { className: "mt-8 pt-6 border-t border-gray-200", children: _jsxs("div", { className: "grid grid-cols-2 gap-4 text-center", children: [_jsxs("div", { className: "bg-blue-50 rounded-xl p-4", children: [_jsx("p", { className: "text-blue-600 font-semibold", children: "T\u1ED5ng giao d\u1ECBch" }), _jsx("p", { className: "text-2xl font-bold text-blue-700", children: depositHistory.length })] }), _jsxs("div", { className: "bg-green-50 rounded-xl p-4", children: [_jsx("p", { className: "text-green-600 font-semibold", children: "T\u1ED5ng \u0111\u00E3 n\u1EA1p" }), _jsxs("p", { className: "text-2xl font-bold text-green-700", children: [formatPrice(depositHistory
                                                                                    .filter(t => t.status === 'approved')
                                                                                    .reduce((sum, t) => sum + parseInt(t.amount), 0)), " VN\u0110"] })] })] }) }))] })] }))] })] })] }), _jsx(Footers, {})] }));
};
export default WalletPage;
